from datetime import datetime, time, timezone

if filtros.get('fecha_inicio') and filtros.get('fecha_fin'):
    inicio_dt = datetime.combine(filtros['fecha_inicio'], time.min, tzinfo=timezone.utc).isoformat()
    fin_dt    = datetime.combine(filtros['fecha_fin'],   time.max, tzinfo=timezone.utc).isoformat()
    condiciones.append('m."createdAt" BETWEEN $1 AND $2')
    parametros.extend([inicio_dt, fin_dt])

















# ğŸ” DEBUG: Ãºltimos 10 registros filtrados
st.write("ğŸ” Ãšltimos 10 registros filtrados:")
st.dataframe(df.tail(10)[["createdAt", "user_id", "content"]])






st.write("ğŸ” DEBUG â€“ Rango filtrado:")
st.write("inicio_dt:", inicio_dt)
st.write("fin_dt  :", fin_dt)
st.write("mÃ­nimo en datos:", df["createdAt"].min())
st.write("mÃ¡ximo en datos:", df["createdAt"].max())
st.write("filas sin filtro:", len(df))
st.write("filas con filtro:", len(df_filtrado))
